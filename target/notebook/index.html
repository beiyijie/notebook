<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>记事本系统 - 登录/注册</title>
    <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/4.6.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding-top: 80px;
            min-height: 100vh;
        }
        .card {
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            border: none;
            overflow: hidden;
        }
        .card-header {
            border-top-left-radius: 20px !important;
            border-top-right-radius: 20px !important;
            border-bottom: none;
            padding: 25px 15px;
            background: linear-gradient(45deg, #6a11cb 0%, #2575fc 100%);
        }
        .login-container {
            max-width: 450px;
            margin: 0 auto;
        }
        .tab-content {
            padding: 30px;
        }
        .nav-tabs {
            border-bottom: none;
            padding: 0 20px;
            background-color: #f8f9fa;
        }
        .nav-tabs .nav-link {
            border: none;
            padding: 15px 20px;
            color: #495057;
            font-weight: 500;
            transition: all 0.3s;
        }
        .nav-tabs .nav-link.active {
            color: #6a11cb;
            border-bottom: 3px solid #6a11cb;
            background-color: transparent;
        }
        .form-control {
            border-radius: 10px;
            padding: 12px 15px;
            border: 1px solid #ced4da;
            margin-bottom: 15px;
        }
        .form-control:focus {
            box-shadow: 0 0 0 3px rgba(106, 17, 203, 0.2);
            border-color: #6a11cb;
        }
        .btn-primary {
            background: linear-gradient(45deg, #6a11cb 0%, #2575fc 100%);
            border: none;
            border-radius: 10px;
            padding: 12px;
            font-weight: 500;
            letter-spacing: 0.5px;
            transition: all 0.3s;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(106, 17, 203, 0.4);
        }
        .card-footer {
            background-color: white;
            border-top: 1px solid rgba(0,0,0,0.05);
            padding: 15px;
        }
        .form-group label {
            font-weight: 500;
            margin-bottom: 8px;
            color: #495057;
        }
        .system-name {
            font-size: 1.8rem;
            font-weight: 700;
        }
        .input-group-prepend .input-group-text {
            border-top-left-radius: 10px;
            border-bottom-left-radius: 10px;
            background-color: #f8f9fa;
        }
        .input-with-icon .form-control {
            padding-left: 45px;
        }
        .input-with-icon {
            position: relative;
        }
        .input-with-icon i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #6c757d;
        }
    </style>
</head>
<body>
    <div class="container login-container">
        <div class="card">
            <div class="card-header text-white text-center">
                <h2 class="system-name mb-0">记事本系统</h2>
                <p class="mb-0 mt-2">记录生活，管理工作</p>
            </div>
            <ul class="nav nav-tabs" id="myTab" role="tablist">
                <li class="nav-item" role="presentation">
                    <a class="nav-link active" id="login-tab" data-toggle="tab" href="#login" role="tab" aria-controls="login" aria-selected="true">
                        <i class="fas fa-sign-in-alt mr-2"></i>登录
                    </a>
                </li>
                <li class="nav-item" role="presentation">
                    <a class="nav-link" id="register-tab" data-toggle="tab" href="#register" role="tab" aria-controls="register" aria-selected="false">
                        <i class="fas fa-user-plus mr-2"></i>注册
                    </a>
                </li>
            </ul>
            <div class="tab-content" id="myTabContent">
                <!-- 登录表单 -->
                <div class="tab-pane fade show active" id="login" role="tabpanel" aria-labelledby="login-tab">
                    <form id="loginForm">
                        <div class="form-group">
                            <label for="loginUsername">用户名</label>
                            <div class="input-with-icon">
                                <i class="fas fa-user"></i>
                                <input type="text" class="form-control" id="loginUsername" name="username" placeholder="请输入用户名" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="loginPassword">密码</label>
                            <div class="input-with-icon">
                                <i class="fas fa-lock"></i>
                                <input type="password" class="form-control" id="loginPassword" name="password" placeholder="请输入密码" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <button type="submit" class="btn btn-primary btn-block mt-4">
                                <i class="fas fa-sign-in-alt mr-2"></i>登录
                            </button>
                        </div>
                    </form>
                </div>
                <!-- 注册表单 -->
                <div class="tab-pane fade" id="register" role="tabpanel" aria-labelledby="register-tab">
                    <form id="registerForm">
                        <div class="form-group">
                            <label for="registerUsername">用户名</label>
                            <div class="input-with-icon">
                                <i class="fas fa-user"></i>
                                <input type="text" class="form-control" id="registerUsername" name="username" placeholder="字母、数字和下划线" required>
                            </div>
                            <small id="usernameHelp" class="form-text text-muted">用户名只能包含字母、数字和下划线</small>
                        </div>
                        <div class="form-group">
                            <label for="registerPassword">密码</label>
                            <div class="input-with-icon">
                                <i class="fas fa-lock"></i>
                                <input type="password" class="form-control" id="registerPassword" name="password" placeholder="请输入密码" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="confirmPassword">确认密码</label>
                            <div class="input-with-icon">
                                <i class="fas fa-check-circle"></i>
                                <input type="password" class="form-control" id="confirmPassword" placeholder="再次输入密码" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="email">邮箱</label>
                            <div class="input-with-icon">
                                <i class="fas fa-envelope"></i>
                                <input type="email" class="form-control" id="email" name="email" placeholder="请输入邮箱地址">
                            </div>
                        </div>
                        <div class="form-group">
                            <button type="submit" class="btn btn-primary btn-block mt-4">
                                <i class="fas fa-user-plus mr-2"></i>注册
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/4.6.0/js/bootstrap.bundle.min.js"></script>
    <script>
        $(document).ready(function() {
            // 登录表单提交
            $("#loginForm").submit(function(e) {
                e.preventDefault();
                
                $.ajax({
                    url: "user/login",
                    type: "POST",
                    data: {
                        username: $("#loginUsername").val(),
                        password: $("#loginPassword").val()
                    },
                    beforeSend: function() {
                        $("#loginForm button").html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> 登录中...');
                        $("#loginForm button").prop("disabled", true);
                    },
                    success: function(res) {
                        if (res.code === 200) {
                            // 登录成功，跳转到主页
                            window.location.href = "main.html";
                        } else {
                            alert(res.message);
                            $("#loginForm button").html('<i class="fas fa-sign-in-alt mr-2"></i>登录');
                            $("#loginForm button").prop("disabled", false);
                        }
                    },
                    error: function() {
                        alert("登录失败，请稍后重试");
                        $("#loginForm button").html('<i class="fas fa-sign-in-alt mr-2"></i>登录');
                        $("#loginForm button").prop("disabled", false);
                    }
                });
            });
            
            // 注册表单提交
            $("#registerForm").submit(function(e) {
                e.preventDefault();
                
                // 验证两次密码是否一致
                var password = $("#registerPassword").val();
                var confirmPassword = $("#confirmPassword").val();
                
                if (password !== confirmPassword) {
                    alert("两次输入的密码不一致");
                    return;
                }
                
                $.ajax({
                    url: "user/register",
                    type: "POST",
                    contentType: "application/json",
                    data: JSON.stringify({
                        username: $("#registerUsername").val(),
                        password: password,
                        email: $("#email").val()
                    }),
                    beforeSend: function() {
                        $("#registerForm button").html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> 注册中...');
                        $("#registerForm button").prop("disabled", true);
                    },
                    success: function(res) {
                        if (res.code === 200) {
                            alert("注册成功，请登录");
                            // 切换到登录页
                            $('#myTab a[href="#login"]').tab('show');
                            // 清空注册表单
                            $("#registerForm")[0].reset();
                            $("#registerForm button").html('<i class="fas fa-user-plus mr-2"></i>注册');
                            $("#registerForm button").prop("disabled", false);
                        } else {
                            alert(res.message);
                            $("#registerForm button").html('<i class="fas fa-user-plus mr-2"></i>注册');
                            $("#registerForm button").prop("disabled", false);
                        }
                    },
                    error: function() {
                        alert("注册失败，请稍后重试");
                        $("#registerForm button").html('<i class="fas fa-user-plus mr-2"></i>注册');
                        $("#registerForm button").prop("disabled", false);
                    }
                });
            });
        });
    </script>
</body>
</html> 